<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>과일샌드위치 포장대작전</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2007216448786117" crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NML6BS1JMB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-NML6BS1JMB');
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    /* 공통 */
    body {
      background: repeating-linear-gradient(135deg, #fdf6f0 0px, #fdf6f0 40px, #ffe7f3 40px, #ffe7f3 80px);
      font-family: 'Press Start 2P', 'Pretendard', monospace, sans-serif;
      margin: 0; min-height: 100vh;
      display: flex; flex-direction: column; align-items: center;
      letter-spacing: 1px;
    }
    /* 시작화면 */
    .title-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      width: 100%;
      max-width: 480px;
      margin: 0 auto;
      padding: 24px;
      text-align: center;
      gap: 24px;
    }
    .title-logo {
      font-size: 2.2rem;
      color: #e95a8b;
      text-shadow: 4px 4px 0 #fff;
      margin-bottom: 16px;
      letter-spacing: 2px;
    }
    .title-sub {
      font-size: 1rem;
      color: #e95a8b;
      text-shadow: 2px 2px 0 #fff;
      margin-bottom: 32px;
    }
    .start-btn, .tutorial-btn {
      border: 3px solid #e95a8b;
      background: #fff3f7;
      color: #e95a8b;
      font-family: 'Press Start 2P', monospace;
      font-size: 0.9rem;
      padding: 12px 24px;
      border-radius: 10px;
      margin: 8px;
      cursor: pointer;
      transition: transform 0.13s, box-shadow 0.13s;
      box-shadow: 4px 4px 0 #e95a8b55;
    }
    .start-btn:hover, .tutorial-btn:hover {
      transform: scale(1.04) rotate(-1deg);
      background: #ffe7f3;
      box-shadow: 0 6px 16px #e95a8b33;
    }
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
    }
    .pixel-art {
      width: 128px; height: 128px;
      background: linear-gradient(135deg, #fff8fb 60%, #ffe7f3 100%);
      border-radius: 24px; border: 4px solid #e95a8b;
      box-shadow: 0 8px 24px #e95a8b33;
      display: flex; align-items: flex-end; justify-content: center; position: relative;
      overflow: hidden;
    }
    /* 게임 화면 */
    #gameScreen {
      display: none;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 480px;
      min-height: 80vh;
      margin: 0 auto;
      padding: 24px 0;
    }
    #timer {
      font-size: 1.1rem;
      color: #e95a8b;
      margin: 32px 0 18px 0;
      text-shadow: 2px 2px 0 #fff;
      font-weight: bold;
      border: 2px dashed #e95a8b;
      background: #fff8fb;
      padding: 8px 24px;
      border-radius: 12px;
      box-shadow: 0 2px 0 #e95a8b44;
      display: inline-block;
    }
    .box-area {
      width: 400px; max-width: 98vw; height: 168px;
      margin: 0 auto 28px auto;
      background: #fff;
      border-radius: 20px 20px 32px 32px;
      box-shadow: 0 0 0 6px #e95a8b, 0 8px 24px #e95a8b33;
      position: relative;
      display: flex; flex-direction: row-reverse; align-items: flex-end; justify-content: flex-start;
      border: 4px dotted #e95a8b;
      overflow: visible;
      gap: 0;
      padding: 18px 24px 18px 24px;
    }
    .pixel-ribbon {
      position: absolute; top: -22px; left: 50%; transform: translateX(-50%);
      background: #fff3f7;
      color: #e95a8b; font-size: 0.85rem; font-weight: bold;
      padding: 6px 18px; border-radius: 8px;
      border: 2px solid #e95a8b;
      box-shadow: 2px 2px 0 #e95a8b66;
      font-family: 'Press Start 2P', monospace;
      z-index: 2;
      letter-spacing: 2px;
    }
    .slot {
      width: 80px; height: 160px;
      margin-left: 10px;
      background: #ffe7f3;
      border: 2px dashed #e95a8b;
      border-radius: 10px 10px 18px 18px;
      display: flex; align-items: center; justify-content: center;
      position: relative;
      box-shadow: 0 2px 0 #e95a8b22;
      transition: background 0.25s;
      overflow: hidden;
    }
    .slot .hint-img {
      position: absolute;
      left: 50%; top: 50%; transform: translate(-50%, -50%);
      width: 55px; height: 150px;
      opacity: 0.23;
      z-index: 1;
      pointer-events: none;
      image-rendering: pixelated;
      filter: blur(0.5px);
    }
    .slot.filled .hint-img {
      display: none;
    }
    .slot.filled {
      background: #fff0f6;
      border-style: solid;
      animation: pop 0.25s;
    }
    @keyframes pop {
      0% { transform: scale(0.8);}
      80% { transform: scale(1.1);}
      100% { transform: scale(1);}
    }
    .slot .real-img {
      width: 62px; height: 150px; object-fit: contain;
      image-rendering: pixelated;
      border-radius: 8px;
      border: 2px solid #e95a8b;
      background: #fff;
      box-shadow: 0 2px 0 #e95a8b22;
      position: relative;
      z-index: 2;
      opacity: 1;
    }
    .slot .emoji {
      position: absolute; bottom: 6px; left: 50%; transform: translateX(-50%);
      font-size: 1.1rem; pointer-events: none;
      opacity: 0.8;
      z-index: 3;
    }
    .sandwich-list {
      display: flex; flex-wrap: wrap; justify-content: center; gap: 8px;
      margin: 0 0 36px 0;
      width: 100%; max-width: 410px;
    }
    .sandwich-btn {
      border: 3px solid #e95a8b;
      background: #fff3f7;
      cursor: pointer; outline: none;
      transition: transform 0.13s, box-shadow 0.13s;
      border-radius: 10px;
      box-shadow: 2px 2px 0 #e95a8b44;
      padding: 0 0 7px 0;
      position: relative;
      font-family: 'Press Start 2P', monospace;
      min-width: 90px;
      min-height: 110px;
      display: flex; flex-direction: column; align-items: center;
    }
    .sandwich-btn:active, .sandwich-btn:focus, .sandwich-btn:hover {
      transform: scale(1.06) rotate(-2deg);
      box-shadow: 0 6px 16px #e95a8b33;
      background: #ffe7f3;
      z-index: 2;
    }
    .sandwich-img {
      width: 64px; height: 120px; object-fit: contain; border-radius: 6px;
      border: 2px solid #e95a8b; background: #fff0f6;
      display: block;
      margin: 10px auto 2px auto;
      transition: box-shadow 0.2s;
      image-rendering: pixelated;
    }
    .sandwich-btn span {
      display: block; text-align: center; font-size: 0.82rem;
      color: #e95a8b; font-weight: 700; letter-spacing: 1px;
      text-shadow: 1px 1px 0 #fff;
      margin-bottom: 2px;
      font-family: 'Press Start 2P', monospace;
      word-break: keep-all;
    }
    .best-score {
      background: #fff3f7;
      border: 3px solid #e95a8b;
      border-radius: 12px;
      padding: 6px 20px;
      margin: 12px auto;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      box-shadow: 2px 2px 0 #e95a8b44;
      font-family: 'Press Start 2P', monospace;
      color: #e95a8b;
      font-size: 0.9rem;
      text-shadow: 1px 1px 0 #fff;
    }
    .score-label {
      font-size: 0.8rem;
    }
    .score-value {
      font-size: 1.1rem;
      font-weight: bold;
      background: #fff;
      border-radius: 8px;
      padding: 4px 12px;
      border: 2px solid #e95a8b;
      box-shadow: 1px 1px 0 #e95a8b66;
    }
  </style>
</head>
<body>
<!-- 시작화면 -->
<div style="width: 100%;height: 10% ">
  <!-- 확장프로그램광고 -->
  <ins class="adsbygoogle" style="display:inline-block;width:100%;min-width:380px; height:90px" data-ad-client="ca-pub-2007216448786117" data-ad-slot="8678539906" data-auto-ads="false"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>
<div class="title-screen" id="titleScreen">
  <div class="pixel-art">
    <img src="strawberry_pixel.png" style="width:48px; position:absolute; left:12px; bottom:16px; filter: drop-shadow(2px 2px 0 #fff);" />
    <img src="kiwi_pixel.png" style="width:48px; position:absolute; left:40px; bottom:24px; z-index:2; filter: drop-shadow(2px 2px 0 #fff);" />
    <img src="banana_pixel.png" style="width:48px; position:absolute; left:68px; bottom:16px; filter: drop-shadow(2px 2px 0 #fff);" />
  </div>
  <div class="title-logo">과일샌드위치 포장대작전</div>
  <!-- 최대 스코어 표시 -->
  <div class="best-score">
    <span class="score-label">최고 기록</span>
    <div id="sandwith_score" class="score-value">0</div>
  </div>
  <div class="title-sub">주문을 맞춰 샌드위치를 포장하세요!</div>
  <div class="btn-group">
    <button class="start-btn" onclick="startGame()">START</button>
    <button class="tutorial-btn" onclick="showTutorial()">게임방법</button>
  </div>
</div>
<div id="tutorialModal" style="
  display: none;
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.7); backdrop-filter: blur(2px);
  z-index: 100; overflow: auto;
">
  <div style="
    background: #fff8fb; border: 4px solid #e95a8b;
    border-radius: 24px; box-shadow: 0 8px 32px #e95a8b55;
    width: 90%; max-width: 400px; margin: 40px auto; padding: 24px;
    min-height: 600px;
    max-height: 700px;
    font-family: 'Press Start 2P', monospace; color: #e95a8b;
    text-align: center;
  ">
    <h2 style="margin: 0 0 16px 0; font-size: 1.4rem;">게임 방법</h2>
    <div style="margin: 0 0 12px 0;">
      <p style="font-size: 0.9rem; margin: 16px 0;">주문에 맞는 샌드위치를 순서대로 포장하세요!</p>
    </div>
    <div style="background: #fff; border-radius: 12px; padding: 12px; margin: 12px 0;">
      <img src="box_pixel.png" style="width: 100%; height: auto; margin: 0 auto; display: block; image-rendering: pixelated;">
      <p style="font-size: 0.8rem; margin: 8px 0;">상자에 들어갈 샌드위치가 보여요. 순서대로 맞추면 성공!</p>
    </div>
    <div style="background: #fff; border-radius: 12px; padding: 12px; margin: 12px 0;">
      <img src="strawberry_pixel.png" style="width: 60px; height: auto; margin: 0 4px; image-rendering: pixelated;">
      <img src="kiwi_pixel.png" style="width: 60px; height: auto; margin: 0 4px; image-rendering: pixelated;">
      <img src="banana_pixel.png" style="width: 60px; height: auto; margin: 0 4px; image-rendering: pixelated;">
      <p style="font-size: 0.8rem; margin: 8px 0;">아래에서 샌드위치를 골라 포장하세요!</p>
    </div>
    <button onclick="hideTutorial()" style="
      background: #e95a8b; color: #fff; border: none;
      padding: 10px 24px; border-radius: 10px; font-size: 0.9rem;
      margin-top: 16px; cursor: pointer; font-family: inherit;
    ">닫기</button>
  </div>
</div>
<!-- 게임 화면 -->
<div id="gameScreen">
  <div id="timer">TIME: 10</div>
  <div class="box-area" id="boxArea">
    <div class="pixel-ribbon" id="boxLabel">🍱 포장용기 1</div>
    <!-- 샌드위치 슬롯이 동적으로 들어감 -->
  </div>
  <div class="sandwich-list" id="sandwichList"></div>
</div>
<!-- 게임오버 모달 -->
<div id="gameOverModal" style="
  display: none;
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.7); backdrop-filter: blur(2px);
  z-index: 100; overflow: auto;
">
  <div style="
    background: #fff8fb; border: 4px solid #e95a8b;
    border-radius: 24px; box-shadow: 0 8px 32px #e95a8b55;
    width: 90%; max-width: 400px; margin: 40px auto; padding: 24px; height: 200px;
    font-family: 'Press Start 2P', monospace; color: #e95a8b;
    text-align: center;
  ">
    <h2 style="margin: 0 0 16px 0; font-size: 1.4rem;">포장 완료!</h2>
    <p id="resultText" style="font-size: 0.9rem; margin: 16px 0;">
      <!-- 결과 문구가 동적으로 들어감 -->
    </p>
    <button onclick="restartGame()" style="
      background: #e95a8b; color: #fff; border: none;
      padding: 10px 24px; border-radius: 10px; font-size: 0.9rem;
      margin-top: 16px; cursor: pointer; font-family: inherit;
    ">다시 시작하기</button>
  </div>
</div>
<div style="width: 100%;height: 10% ">
  <ins class="adsbygoogle" style="display:inline-block;width:100%;min-width:380px; height:90px" data-ad-client="ca-pub-2007216448786117" data-ad-slot="8678539906" data-auto-ads="false"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>
<script>
  const sandwiches = [
    { name: '딸기샌드', img: 'strawberry_pixel.png' },
    { name: '키위샌드', img: 'kiwi_pixel.png' },
    { name: '바나나샌드', img: 'banana_pixel.png' },
    { name: '포도샌드', img: 'grape_pixel.png' },
    { name: '오렌지샌드', img: 'orange_pixel.png' },
    { name: '베리샌드', img: 'berry_pixel.png' },
    { name: '망고샌드', img: 'mango_pixel.png' }
  ];

  let round = 1;
  let time = 10;
  let timerId = null;
  let boxSandwiches = [];
  let filled = 0;

  function startGame() {
    document.getElementById('titleScreen').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'flex';
    reset();
  }


  function getAvailableSandwiches() {
    const baseCount = 3; // 초기 3종
    const addCount = Math.floor((round - 1) / 5);
    return sandwiches.slice(0, baseCount + addCount);
  }

  function getBoxSandwichCount() {
    const available = getAvailableSandwiches();
    const addCountMax = Math.floor((round - 1) / 5);
    const addCountMin = Math.floor((round - 1) / 10);

    let min = Math.max(1, 1 + addCountMin);
    let max = Math.min(5, 2 + addCountMax);

    if (min > max) min = max;

    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function getTimeLimit() {
    return Math.max(3, 10 - Math.floor((round - 1) / 5));
  }

  function nextBox() {
    filled = 0;
    const available = getAvailableSandwiches();
    const count = getBoxSandwichCount();
    boxSandwiches = shuffle([...available]).slice(0, count);
    setSandwichList();
    time = getTimeLimit();
    updateTimer();
    if (timerId) clearInterval(timerId);
    startTimer();
    setBoxArea();
  }

  function setBoxArea() {
    const box = document.getElementById('boxArea');
    box.querySelectorAll('.slot').forEach(e => e.remove());
    document.getElementById('boxLabel').textContent = `🍱 포장용기 ${round}`;
    for (let i = 0; i < boxSandwiches.length; ++i) {
      const slot = document.createElement('div');
      slot.className = 'slot' + (i < filled ? ' filled' : '');
      const hintImg = document.createElement('img');
      hintImg.className = 'hint-img';
      hintImg.src = boxSandwiches[i].img;
      hintImg.alt = boxSandwiches[i].name;
      slot.appendChild(hintImg);
      if (i < filled) {
        const realImg = document.createElement('img');
        realImg.className = 'real-img';
        realImg.src = boxSandwiches[i].img;
        realImg.alt = boxSandwiches[i].name;
        slot.appendChild(realImg);
      }
      box.insertBefore(slot, box.querySelector('.pixel-ribbon').nextSibling);
    }
  }

  function setSandwichList() {
    const list = document.getElementById('sandwichList');
    list.innerHTML = '';
    const available = getAvailableSandwiches();
    available.forEach((s, idx) => {
      const btn = document.createElement('button');
      btn.className = 'sandwich-btn';
      btn.onclick = () => check(idx);
      btn.innerHTML = `<img class="sandwich-img" src="${s.img}" alt="${s.name}"><span>${s.name}</span>`;
      list.appendChild(btn);
    });
  }


  function check(idx) {
    const available = getAvailableSandwiches();
    if (available[idx].name === boxSandwiches[filled].name) {
      filled++;
      setBoxArea();
      if (filled >= boxSandwiches.length) {
        setTimeout(() => {
          round++;
          nextBox();
        }, 500);
      }
    } else {
      time -= 2; // 실수 시 시간 감점
      updateTimer();
    }
  }

  function updateTimer() {
    document.getElementById('timer').textContent = `TIME: ${time}`;

    const highScore = localStorage.getItem('sandwith_score') || 0;
    if (time <= 0) {
      clearInterval(timerId);
      document.getElementById('gameScreen').style.display = 'none';
      if (round - 1 > highScore) {
        localStorage.setItem('sandwith_score', round - 1);
      }
      // 결과 문구 동적 출력
      const resultText = document.getElementById('resultText');
      resultText.innerHTML = `총 <strong>${round - 1}</strong>개의 박스를 포장했습니다!`;
      document.getElementById('gameOverModal').style.display = 'flex';
    }
  }

  // 타이머 시작
  function startTimer() {
    timerId = setInterval(() => {
      time--;
      updateTimer();
      if (time <= 0) clearInterval(timerId);
    }, 1000);
  }

  // 배열 섞기
  function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  // 게임 리셋
  function reset() {
    round = 1;
    time = getTimeLimit();
    nextBox();
    updateTimer();
    if (timerId) clearInterval(timerId);

    startTimer();

    setSandwichList();
  }
  function showTutorial() {
    document.getElementById('tutorialModal').style.display = 'flex';
  }
  function hideTutorial() {
    document.getElementById('tutorialModal').style.display = 'none';
  }

  function restartGame() {
    displayHighScore();
    document.getElementById('gameOverModal').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'none';
    document.getElementById('titleScreen').style.display = 'flex';
  }
  function displayHighScore() {
    const highScore = localStorage.getItem('sandwith_score') || 0;
    document.getElementById('sandwith_score').textContent = highScore;
  }

  document.getElementById('gameScreen').style.display = 'none';
  document.addEventListener('DOMContentLoaded', displayHighScore);
</script>
</body>
</html>
