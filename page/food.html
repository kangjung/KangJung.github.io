<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ìŒì‹ ëœë¤ ë½‘ê¸° - ì˜¤ëŠ˜ ë­ ë¨¹ì§€? ê²°ì •ì¥ì•  í•´ê²° ë„êµ¬</title>
  <meta name="description" content="ì˜¤ëŠ˜ ë©”ë‰´ ê³ ë¯¼ ë! ë£°ë ›, ìŠ¬ë¡¯ë¨¸ì‹ , ì‚¬ë‹¤ë¦¬ íƒ€ê¸°ë¡œ ì ì‹¬ ë©”ë‰´ë¥¼ ëœë¤ìœ¼ë¡œ ë½‘ì•„ë³´ì„¸ìš”. ë‚˜ë§Œì˜ ë©”ë‰´ ì„¸íŠ¸ ì €ì¥ ê¸°ëŠ¥ê¹Œì§€ ì œê³µí•˜ëŠ” ìµœê³ ì˜ ìŒì‹ ê²°ì • ë„êµ¬ì…ë‹ˆë‹¤.">
  <meta name="keywords" content="ìŒì‹ëœë¤ë½‘ê¸°, ë©”ë‰´ì¶”ì²œ, ì˜¤ëŠ˜ë­ë¨¹ì§€, ì ì‹¬ë©”ë‰´ì¶”ì²œ, ë£°ë ›ëŒë¦¬ê¸°, ì‚¬ë‹¤ë¦¬íƒ€ê¸°">

  <meta property="og:title" content="ìŒì‹ ëœë¤ ë½‘ê¸° - ì˜¤ëŠ˜ ë­ ë¨¹ì§€?">
  <meta property="og:description" content="ë£°ë ›, ìŠ¬ë¡¯ë¨¸ì‹ ìœ¼ë¡œ ì¬ë°Œê²Œ ì •í•˜ëŠ” ì˜¤ëŠ˜ì˜ í•œ ë¼!">
  <meta property="og:url" content="https://yourdomain.com">
  <meta property="og:type" content="website">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2007216448786117" crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NML6BS1JMB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-NML6BS1JMB');
  </script>
  <title>ìŒì‹ ëœë¤ ë½‘ê¸°</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      font-size: 16px;
      background: #f4f5fb;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      margin-bottom: 10px;
    }

    .container {
      width: 100%;
      max-width: 900px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      padding: 20px;
      box-sizing: border-box;
    }

    .mode-select {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .mode-btn {
      flex: 1;
      min-width: 80px;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      background: #fafafa;
      cursor: pointer;
      font-size: 14px;
      transition: all .15s ease;
      white-space: nowrap;
    }

    .mode-btn.active {
      background: #4f46e5;
      color: #fff;
      border-color: #4f46e5;
    }

    .inputs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .inputs input {
      flex: 1;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 14px;
      box-sizing: border-box;
    }

    .inputs button {
      padding: 10px 12px;
      border-radius: 8px;
      border: none;
      background: #10b981;
      color: #fff;
      cursor: pointer;
      font-size: 14px;
      white-space: nowrap;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      background: #eef2ff;
      border-radius: 999px;
      font-size: 13px;
      max-width: 100%;
    }

    .chip span {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 150px;
    }

    .chip button {
      border: none;
      background: transparent;
      cursor: pointer;
      color: #6b7280;
      font-size: 12px;
    }

    .actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      flex-wrap: wrap;
      gap: 8px;
    }

    .actions button {
      padding: 8px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      white-space: nowrap;
    }

    .primary-btn {
      background: #4f46e5;
      color: #fff;
    }

    .secondary-btn {
      background: #e5e7eb;
      color: #374151;
    }

    .result {
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      margin-top: 16px;
      min-height: 26px;
    }

    .hint {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 6px;
    }

    /* ë£°ë › ìŠ¤íƒ€ì¼ */
    #rouletteView {
      display: flex;
      justify-content: center;
    }
    .roulette-wrapper {
      margin: 10px auto 0;
      width: 360px;
      height: 360px;
      border-radius: 50%;
      border: 10px solid #4f46e5;
      position: relative;
      overflow: visible; /* í…ìŠ¤íŠ¸ê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡ */
      background: #fff;
    }

    .roulette-svg {
      width: 100%;
      height: 100%;
      transform: rotate(-90deg); /* 0ë„ ë°©í–¥ì„ ìœ„ìª½ìœ¼ë¡œ */
    }

    .roulette-label {
      font-size: 16px;
      font-weight: 600;
      fill: #111827;
      text-anchor: middle;
      dominant-baseline: middle;
    }

    /* ë£°ë › í™”ì‚´í‘œ */
    .roulette-arrow {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 14px solid transparent;
      border-right: 14px solid transparent;
      border-top: 26px solid #ef4444;
      z-index: 10;
    }

    /* ìŠ¬ë¡¯ë¨¸ì‹  ìŠ¤íƒ€ì¼ */
    #slotView {
      margin-top: 10px;
    }

    .slot-wrapper {
      position: relative;
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 10px;
    }

    .slot-center-line {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 0;
      border-top: 3px solid #f59e0b;
      transform: translateY(-50%);
      pointer-events: none;
      z-index: 10;
      box-shadow: 0 0 6px rgba(245,158,11,.8);
    }

    .slot-column {
      width: 120px;
      height: 170px;
      border-radius: 8px;
      border: 2px solid #4b5563;
      overflow: hidden;
      background: #111827;
      color: #f9fafb;
      position: relative;
    }

    .slot-inner {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      transition: transform 1.5s ease-out;
    }

    .slot-item {
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-bottom: 1px solid rgba(55,65,81,0.7);
      font-size: 16px;
      padding: 0 6px;
      box-sizing: border-box;
      text-align: center;
      word-break: keep-all;
    }
    .slot-item.active {
      color: #facc15;
      font-weight: 700;
      text-shadow: 0 0 6px rgba(250, 204, 21, 0.8);
    }

    /* ì‚¬ë‹¤ë¦¬ ìŠ¤íƒ€ì¼ */
    #ladderView {
      margin-top: 10px;
    }

    .ladder-wrapper {
      margin-top: 8px;
      display: flex;
      justify-content: center;
      gap: 28px;
      position: relative;
      padding-bottom: 20px;
      overflow-x: auto;
    }

    .ladder-column {
      width: 4px;
      background: #4b5563;
      height: 260px;
      position: relative;
    }

    .ladder-horizontal {
      position: absolute;
      height: 3px;
      background: #111827;
      border-radius: 2px;
    }

    .ladder-label {
      text-align: center;
      margin-top: 6px;
      font-size: 14px;
      font-weight: 600;
      max-width: 100px;
      word-break: keep-all;
    }

    .ladder-marker {
      position: absolute;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #f97316;
      left: 50%;
      transform: translateX(-50%);
      top: -9px;
      transition: top .12s linear, left .12s linear;
      z-index: 5;
      box-shadow: 0 0 6px rgba(0,0,0,0.4);
    }

    @media (max-width: 640px) {
      .roulette-wrapper {
        width: 280px;
        height: 280px;
      }
      .slot-column {
        width: 90px;
      }
      .ladder-wrapper {
        gap: 24px;
      }
    }
    .ladder-top {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      border: 2px solid #4f46e5;
      background: #fff;
      cursor: pointer;
    }
    .ladder-top:hover {
      background: #4f46e5;
    }
  </style>
</head>
<body>
<h1>ìŒì‹ ëœë¤ ë½‘ê¸°</h1>
<div class="adsense ads-top">
  <ins class="adsbygoogle" style="display:inline-block;width:100%;min-width:380px; height:90px" data-ad-client="ca-pub-2007216448786117" data-ad-slot="8678539906"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>
<div class="container">
  <div class="mode-select">
    <button class="mode-btn active" data-mode="roulette">ë£°ë ›</button>
    <button class="mode-btn" data-mode="slot">ìŠ¬ë¡¯ë¨¸ì‹ </button>
    <button class="mode-btn" data-mode="ladder">ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</button>
  </div>

  <div class="hint">ì‹ì‚¬ í›„ë³´ë¥¼ ì…ë ¥ í›„ ì—”í„° ë˜ëŠ” â€œì¶”ê°€â€ë¥¼ ëˆ„ë¥´ì„¸ìš”.</div>

  <div class="inputs">
    <input id="itemInput" type="text" placeholder="ì˜ˆ: ê¹€ì¹˜ì°Œê°œ, ëˆê¹ŒìŠ¤, ì´ˆë°¥..." />
    <button id="addItemBtn">ì¶”ê°€</button>
  </div>

  <div class="chips" id="chips"></div>

  <div class="actions" style="align-items:flex-start;">
    <div style="display:flex; gap:6px; flex-wrap:wrap; align-items:center;">
      <select
        id="userPresetSelect"
        class="secondary-btn"
        title="ì €ì¥í•´ ë‘” ë‚˜ë§Œì˜ ë©”ë‰´ ì„¸íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤"
      ></select>

      <button
        class="secondary-btn"
        id="savePresetBtn"
        title="í˜„ì¬ ë©”ë‰´ ëª©ë¡ì„ ìƒˆë¡œìš´ ì„¸íŠ¸ë¡œ ì €ì¥í•©ë‹ˆë‹¤"
      >
        ğŸ’¾ ì„¸íŠ¸ ì €ì¥
      </button>

      <button
        class="secondary-btn"
        id="deletePresetBtn"
        title="ì„ íƒí•œ ë©”ë‰´ ì„¸íŠ¸ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤"
      >
        ğŸ—‘ ì„¸íŠ¸ ì‚­ì œ
      </button>
    </div>

    <button class="primary-btn" id="startBtn" title="í˜„ì¬ ë©”ë‰´ë¡œ ëœë¤ ì¶”ì²¨ì„ ì‹œì‘í•©ë‹ˆë‹¤">
      ğŸ² ë½‘ê¸° ì‹œì‘
    </button>
  </div>
  <!-- ë£°ë › -->
  <div id="rouletteView">
    <div class="roulette-wrapper">
      <div class="roulette-arrow"></div>
      <svg id="rouletteSvg" viewBox="0 0 400 400" class="roulette-svg">
        <!-- JSì—ì„œ path, textë¥¼ ì±„ì›Œ ë„£ìŒ -->
      </svg>
    </div>
  </div>

  <!-- ìŠ¬ë¡¯ë¨¸ì‹  -->
  <div id="slotView" style="display:none;">
    <div class="slot-wrapper">
      <div class="slot-center-line"></div>
      <div class="slot-column">
        <div class="slot-inner" id="slotCol1"></div>
      </div>
      <div class="slot-column">
        <div class="slot-inner" id="slotCol2"></div>
      </div>
      <div class="slot-column">
        <div class="slot-inner" id="slotCol3"></div>
      </div>
    </div>
  </div>

  <!-- ì‚¬ë‹¤ë¦¬ -->
  <div id="ladderView" style="display:none;">
    <div class="ladder-wrapper" id="ladderWrapper"></div>
  </div>
  <div class="result" id="result"></div>
  <div style="display:flex; gap:8px; justify-content:center; margin-top:10px;">
    <button class="secondary-btn" id="copyLinkBtn">
      ğŸ“¤ ê²°ê³¼ ë³µì‚¬í•˜ê¸°
    </button>
  </div>
</div>
<div class="adsense ads-result">
  <ins class="adsbygoogle" style="display:inline-block;width:100%;min-width:380px; height:90px" data-ad-client="ca-pub-2007216448786117" data-ad-slot="8678539906" data-auto-ads="false"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

<script>
  const modes = document.querySelectorAll('.mode-btn');
  const rouletteView = document.getElementById('rouletteView');
  const slotView = document.getElementById('slotView');
  const ladderView = document.getElementById('ladderView');
  const startBtn = document.getElementById('startBtn');
  const presetBtn = document.getElementById('presetBtn');
  const input = document.getElementById('itemInput');
  const addItemBtn = document.getElementById('addItemBtn');
  const chipsEl = document.getElementById('chips');
  const resultEl = document.getElementById('result');
  const topEl = document.querySelectorAll('.ladder-top');
  const LAST_SELECTED_PRESET_KEY = 'lastSelectedMenuPreset';

  let currentMode = 'roulette';
  let items = [];

  const USER_PRESET_KEY = 'userMenuPresets';

  function loadUserPresets() {
    return JSON.parse(localStorage.getItem(USER_PRESET_KEY) || '{}');
  }

  function saveUserPresets(presets) {
    localStorage.setItem(USER_PRESET_KEY, JSON.stringify(presets));
  }

  const userPresetSelect = document.getElementById('userPresetSelect');

  function renderUserPresetSelect() {
    const presets = loadUserPresets();
    userPresetSelect.innerHTML = '<option value="">ë‚´ ë©”ë‰´ì„¸íŠ¸</option>';

    Object.keys(presets).forEach(name => {
      const opt = document.createElement('option');
      opt.value = name;
      opt.textContent = name;
      userPresetSelect.appendChild(opt);
    });
  }
  document.getElementById('savePresetBtn').addEventListener('click', () => {
    if (!items.length) {
      alert('ì €ì¥í•  ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }

    const name = prompt('ë©”ë‰´ ì„¸íŠ¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”');
    if (!name) return;

    const presets = loadUserPresets();
    presets[name] = [...items];
    saveUserPresets(presets);
    renderUserPresetSelect();
    alert(`"${name}" ì„¸íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
  });

  document.getElementById('copyLinkBtn').addEventListener('click', async () => {
    const result = resultEl.textContent;
    if (!result) {
      alert('ë¨¼ì € ê²°ê³¼ë¥¼ ë½‘ì•„ì£¼ì„¸ìš”!');
      return;
    }

    const text =
      `ğŸ½ ì˜¤ëŠ˜ ë©”ë‰´ ëœë¤ ë½‘ê¸° ê²°ê³¼!

${result}

ğŸ¤” ë§¤ë²ˆ ë­ ë¨¹ì„ì§€ ê³ ë¯¼ëœë‹¤ë©´?
ğŸ‘‡ ì—¬ê¸°ì„œ ë°”ë¡œ ë½‘ì•„ë³´ì„¸ìš”
${location.origin}${location.pathname}`;

    try {
      await navigator.clipboard.writeText(text);
      toast('ê²°ê³¼ì™€ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    } catch {
      toast('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  });

  function toast(msg) {
    const t = document.createElement('div');
    t.textContent = msg;
    t.style.cssText = `
    position:fixed; bottom:20px; left:50%;
    transform:translateX(-50%);
    background:#333; color:#fff;
    padding:10px 14px; border-radius:8px;
    z-index:9999;
  `;
    document.body.appendChild(t);
    setTimeout(() => t.remove(), 1800);
  }
  userPresetSelect.addEventListener('change', () => {
    const name = userPresetSelect.value;
    if (!name) return;

    const presets = loadUserPresets();
    items = [...presets[name]];

    // âœ… ë§ˆì§€ë§‰ ì„ íƒ ì„¸íŠ¸ ì €ì¥
    localStorage.setItem(LAST_SELECTED_PRESET_KEY, name);

    renderChips();
    updateView();
  });

  document.getElementById('deletePresetBtn').addEventListener('click', () => {
    const name = userPresetSelect.value;
    if (!name) {
      alert('ì‚­ì œí•  ì„¸íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”.');
      return;
    }

    if (!confirm(`"${name}" ì„¸íŠ¸ë¥¼ ì‚­ì œí• ê¹Œìš”?`)) return;

    const presets = loadUserPresets();
    delete presets[name];
    saveUserPresets(presets);
    renderUserPresetSelect();
    if (name === localStorage.getItem(LAST_SELECTED_PRESET_KEY)) {
      localStorage.removeItem(LAST_SELECTED_PRESET_KEY);

      // ê¸°ë³¸ ì„¸íŠ¸ë¡œ ë³µê·€
      items = [...presetSets.basic.items];
      renderChips();
      updateView();
    }
  });
  document.querySelectorAll('.preset-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const key = btn.dataset.preset;
      items = [...presetSets[key].items];
      renderChips();
      localStorage.setItem('lastPreset', key);
      updateView();
    });
  });

  // ëª¨ë“œ ë³€ê²½
  modes.forEach(btn => {
    btn.addEventListener('click', () => {
      modes.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentMode = btn.dataset.mode;
      updateView();
    });
  });

  let selectedStartIndex = null;
  topEl.forEach(btn => {
    btn.addEventListener('click', () => {
      selectedStartIndex = index;
      runLadder(selectedStartIndex);
    });
  });

  function updateView() {
    startBtn.style.display = currentMode === 'ladder' ? 'none' : 'block';
    rouletteView.style.display = currentMode === 'roulette' ? 'flex' : 'none';
    slotView.style.display = currentMode === 'slot' ? 'block' : 'none';
    ladderView.style.display = currentMode === 'ladder' ? 'block' : 'none';
    resultEl.textContent = '';
    if (currentMode === 'roulette') buildRoulette();
    if (currentMode === 'slot') buildSlot();
    if (currentMode === 'ladder') buildLadder();
  }

  const presetSets = {
    basic: {
      label: "ê¸°ë³¸ ì ì‹¬",
      items: ["ê¹€ì¹˜ì°Œê°œ","ë¶€ëŒ€ì°Œê°œ","ëˆê¹ŒìŠ¤","ì´ˆë°¥","í–„ë²„ê±°","íŒŒìŠ¤íƒ€","ìŒ€êµ­ìˆ˜","ë¹„ë¹”ë°¥"]
    },
    quick: {
      label: "ë¹ ë¥¸ ì ì‹¬",
      items: ["ê¹€ë°¥","ë¼ë©´","ì»µë°¥","í¸ì˜ì  ë„ì‹œë½","í† ìŠ¤íŠ¸","ìƒŒë“œìœ„ì¹˜","í–„ë²„ê±°"]
    },
    cheap: {
      label: "ê°€ì„±ë¹„",
      items: ["êµ­ë°¥","ì œìœ¡ë®ë°¥","ì¹¼êµ­ìˆ˜","ë¶„ì‹","ê¹€ì¹˜ë³¶ìŒë°¥","ë¼ë©´"]
    },
    light: {
      label: "ê°€ë²¼ìš´ ë‚ ",
      items: ["ìƒëŸ¬ë“œ","í¬ì¼€","ë‹­ê°€ìŠ´ì‚´","ìƒŒë“œìœ„ì¹˜","ë‘ë¶€ë®ë°¥"]
    }
  };

  // ê¸°ë³¸ ë©”ë‰´ í”„ë¦¬ì…‹
  // const presetMenus = ["ê¹€ì¹˜ì°Œê°œ", "ë¶€ëŒ€ì°Œê°œ", "ëˆê¹ŒìŠ¤", "ì´ˆë°¥", "í–„ë²„ê±°", "íŒŒìŠ¤íƒ€", "ìŒ€êµ­ìˆ˜", "ë¹„ë¹”ë°¥"];
  //
  // presetBtn.addEventListener('click', () => {
  //   items = [...presetMenus];
  //   renderChips();
  //   updateView();
  // });

  // ì•„ì´í…œ ì¶”ê°€
  function addItemFromInput() {
    const value = input.value.trim();
    if (!value) return;
    items.push(value);
    input.value = '';
    renderChips();
    updateView();
  }

  input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') addItemFromInput();
  });

  addItemBtn.addEventListener('click', addItemFromInput);

  function renderChips() {
    chipsEl.innerHTML = '';
    items.forEach((text, idx) => {
      const chip = document.createElement('div');
      chip.className = 'chip';
      chip.innerHTML = `<span>${text}</span><button data-index="${idx}">âœ•</button>`;
      chipsEl.appendChild(chip);
    });

    chipsEl.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', () => {
        const i = Number(btn.dataset.index);
        items.splice(i, 1);
        renderChips();
        updateView();
      });
    });
  }

  // ê³µí†µ: ëœë¤ ì„ íƒ
  function pickRandom() {
    if (!items.length) return null;
    const index = Math.floor(Math.random() * items.length);
    return { index, value: items[index] };
  }

  // ë£°ë › êµ¬ì„±
  const rouletteWheel = document.getElementById('rouletteWheel');
  const rouletteSectors = document.getElementById('rouletteSectors');
  let rouletteRotation = 0;
  const rouletteSvg = document.getElementById('rouletteSvg');

  function buildRoulette() {
    rouletteSvg.innerHTML = '';
    if (!items.length) return;

    const count = items.length;
    const angle = 360 / count;
    const cx = 200;
    const cy = 200;
    const rOuter = 190;
    const rInner = 0;

    for (let i = 0; i < count; i++) {
      const startAngle = angle * i;
      const endAngle = angle * (i + 1);
      const largeArc = angle > 180 ? 1 : 0;

      const startRad = (Math.PI / 180) * startAngle;
      const endRad   = (Math.PI / 180) * endAngle;

      const x1 = cx + rOuter * Math.cos(startRad);
      const y1 = cy + rOuter * Math.sin(startRad);
      const x2 = cx + rOuter * Math.cos(endRad);
      const y2 = cy + rOuter * Math.sin(endRad);

      const pathData = [
        `M ${cx} ${cy}`,
        `L ${x1} ${y1}`,
        `A ${rOuter} ${rOuter} 0 ${largeArc} 1 ${x2} ${y2}`,
        'Z'
      ].join(' ');

      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      path.setAttribute('d', pathData);
      path.setAttribute('fill', i % 2 === 0 ? '#fee2e2' : '#bfdbfe');
      rouletteSvg.appendChild(path);

      // ë¼ë²¨ ìœ„ì¹˜ (ë¶€ì±„ê¼´ ì¤‘ì•™ ê°ë„ ë°©í–¥ìœ¼ë¡œ)
      const midAngle = (startAngle + endAngle) / 2;
      const midRad = (Math.PI / 180) * midAngle;
      const labelRadius = 120;
      const lx = cx + labelRadius * Math.cos(midRad);
      const ly = cy + labelRadius * Math.sin(midRad);

      const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
      text.classList.add('roulette-label');
      text.setAttribute('x', lx);
      text.setAttribute('y', ly);
      text.setAttribute('transform', `rotate(${midAngle}, ${lx}, ${ly})`);
      text.textContent = items[i];
      rouletteSvg.appendChild(text);
    }
  }

  function spinRoulette() {
    if (!items.length) {
      alert('ë¨¼ì € ë©”ë‰´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!');
      return;
    }

    const count = items.length;
    const anglePer = 360 / count;

    // ëœë¤ íšŒì „ ê°ë„
    const randomAngle = Math.random() * 360;
    const rounds = 5;

    rouletteRotation += rounds * 360 + randomAngle;

    rouletteSvg.style.transition =
      'transform 3s cubic-bezier(0.2, 0.8, 0.2, 1)';
    rouletteSvg.style.transform =
      `rotate(${rouletteRotation - 90}deg)`; // -90ì€ SVG ë³´ì •

    resultEl.textContent = '';

    setTimeout(() => {
      /*
        í™”ì‚´í‘œëŠ” 12ì‹œ(0ë„)
        í˜„ì¬ íšŒì „ê°’ì„ 0~360ìœ¼ë¡œ ì •ê·œí™” í›„
        ì–´ë–¤ ì„¹í„°ê°€ ìœ„ì— ì™”ëŠ”ì§€ ê³„ì‚°
      */
      const normalized =
        (360 - (rouletteRotation % 360)) % 360;

      const index =
        Math.floor(normalized / anglePer) % count;

      resultEl.textContent =
        `ì˜¤ëŠ˜ ë°¥ì€ "${items[index]}" !`;
    }, 3100);
  }



  // ìŠ¬ë¡¯ë¨¸ì‹  êµ¬ì„±
  const slotCols = [
    document.getElementById('slotCol1'),
    document.getElementById('slotCol2'),
    document.getElementById('slotCol3')
  ];

  function buildSlot() {
    slotCols.forEach(col => {
      col.innerHTML = '';
      if (!items.length) return;

      const repeatCount = 10;
      const list = Array.from({ length: repeatCount }, () => items).flat();

      list.forEach(text => {
        const item = document.createElement('div');
        item.className = 'slot-item';
        item.textContent = text;
        col.appendChild(item);
      });

      col.style.transition = 'none';
      col.style.transform = 'translateY(0)';
    });
  }


  function spinSlot() {
    if (!items.length) {
      alert('ë¨¼ì € ë©”ë‰´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!');
      return;
    }

    const itemHeight = 50;
    const visibleOffset = 2; // ìŠ¬ë¡¯ ì¤‘ì•™ ìœ„ì¹˜
    const rounds = 2;

    // âœ… ìŠ¬ë¡¯ì´ ë©ˆì¶œ ìŒì‹ indexë¥¼ ë¨¼ì € ê²°ì •
    const resultIndex = Math.floor(Math.random() * items.length);
    const resultValue = items[resultIndex];

    slotCols.forEach((col, colIdx) => {
      const delay = colIdx * 150;

      const targetIndex =
        rounds * items.length + resultIndex + visibleOffset;

      const distance = targetIndex * itemHeight;

      setTimeout(() => {
        col.style.transition = 'transform 1.5s ease-out';
        col.style.transform = `translateY(-${distance}px)`;
      }, delay);

      // ğŸ” ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ í›„ ìœ„ì¹˜ ì •ë¦¬
      setTimeout(() => {
        col.style.transition = 'none';
        col.style.transform =
          `translateY(-${(resultIndex + visibleOffset) * itemHeight}px)`;
      }, 1700 + delay);
    });

    resultEl.textContent = '';

    setTimeout(() => {
      const col = slotCols[1]; // ê°€ìš´ë° ì»¬ëŸ¼ ê¸°ì¤€
      const lineY =
        document.querySelector('.slot-center-line')
          .getBoundingClientRect().top;

      let selectedItem = null;
      let minDistance = Infinity;

      Array.from(col.children).forEach(item => {
        const rect = item.getBoundingClientRect();
        const center = rect.top + rect.height / 2;
        const dist = Math.abs(center - lineY);

        if (dist < minDistance) {
          minDistance = dist;
          selectedItem = item;
        }
      });

      const value = selectedItem?.textContent || '';
      resultEl.textContent = `ì˜¤ëŠ˜ ì ì‹¬ì€ "${value}" !`;
    }, 1900);

  }


  function buildLadder() {
    const wrapper = document.getElementById('ladderWrapper');
    wrapper.innerHTML = '';
    if (!items.length) return;
    const count = items.length;
    const height = 240;
    const topRow = document.createElement('div');
    topRow.style.display = 'flex';
    topRow.style.justifyContent = 'center';
    topRow.style.gap = '28px';
    topRow.style.marginBottom = '6px';


    wrapper.appendChild(topRow);
    const marker = document.createElement('div');
    marker.className = 'ladder-marker';
    wrapper.appendChild(marker);

    const columns = [];
    for (let i = 0; i < count; i++) {
      const colContainer = document.createElement('div');
      colContainer.style.display = 'flex';
      colContainer.style.flexDirection = 'column';
      colContainer.style.alignItems = 'center';

      const top = document.createElement('div');
      top.className = 'ladder-top';
      top.dataset.index = i;
      top.addEventListener('click', () => runLadder(i));

      colContainer.appendChild(top);

      // ğŸ”¹ ì„¸ë¡œì¤„
      const col = document.createElement('div');
      col.className = 'ladder-column';
      col.dataset.index = i;
      colContainer.appendChild(col);

      // ğŸ”¹ í•˜ë‹¨ ë¼ë²¨
      const label = document.createElement('div');
      label.className = 'ladder-label';
      label.textContent = items[i];
      colContainer.appendChild(label);

      wrapper.appendChild(colContainer);
      columns.push(col);
    }


    const horizontalLines = [];
    const steps = 9;

    for (let s = 0; s < steps; s++) {
      const y = (height / (steps + 1)) * (s + 1);

      for (let i = 0; i < count - 1; i++) {
        if (Math.random() < 0.5) {
          const h = document.createElement('div');
          h.className = 'ladder-horizontal';
          h.style.top = y + 'px';

          const leftCol = columns[i];
          const rightCol = columns[i + 1];

          const leftX =
            leftCol.getBoundingClientRect().left -
            wrapper.getBoundingClientRect().left;

          const rightX =
            rightCol.getBoundingClientRect().left -
            wrapper.getBoundingClientRect().left;

          h.style.left = leftX + 'px';
          h.style.width = (rightX - leftX) + 'px';

          h.dataset.from = i;
          h.dataset.to = i + 1;

          wrapper.appendChild(h);
          horizontalLines.push(h);
        }
      }
    }

    wrapper.dataset.markerIndex = 0;
    wrapper.dataset.height = height;

    wrapper._ladderData = {
      columns,
      horizontalLines,
      marker
    };
  }

  function runLadder(startIndex) {
    let currentIndex = startIndex;
    const wrapper = document.getElementById('ladderWrapper');
    if (!items.length) {
      alert('ë¨¼ì € ë©”ë‰´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!');
      return;
    }
    if (!wrapper._ladderData) {
      buildLadder();
    }
    const { columns, horizontalLines, marker } = wrapper._ladderData;
    const height = Number(wrapper.dataset.height || 240);
    let y = 0;
    const step = 12;

    const wrapRect = wrapper.getBoundingClientRect();
    marker.style.top = '-9px';
    marker.style.left =
      columns[currentIndex].getBoundingClientRect().left - wrapRect.left + 3 + 'px';

    const sortedLines = horizontalLines
      .map(h => ({
        y: parseFloat(h.style.top),
        from: Number(h.dataset.from),
        to: Number(h.dataset.to),
        el: h
      }))
      .sort((a, b) => a.y - b.y);

    const path = [];

    while (y < height) {
      const nextLine = sortedLines.find(l =>
        !l.used &&
        l.y >= y &&
        l.y < y + step * 2 &&
        (l.from === currentIndex || l.to === currentIndex)
      );

      if (nextLine) {
        y = nextLine.y;
        path.push({ x: currentIndex, y });
        currentIndex = nextLine.from === currentIndex ? nextLine.to : nextLine.from;
        nextLine.used = true;
      } else {
        y += step;
        path.push({ x: currentIndex, y });
      }
    }

    let i = 0;
    resultEl.textContent = '';
    const timer = setInterval(() => {
      if (i >= path.length) {
        clearInterval(timer);
        const value = items[currentIndex];
        resultEl.textContent = `ì˜¤ëŠ˜ ì ì‹¬ì€ "${value}" !`;
        return;
      }
      const p = path[i];
      const col = columns[p.x];
      const colRect = col.getBoundingClientRect();
      const wrapRect2 = wrapper.getBoundingClientRect();
      marker.style.left = (colRect.left - wrapRect2.left + 3) + 'px';
      marker.style.top = (p.y - 9) + 'px';
      i++;
    }, 60);
  }

  // ì‹œì‘ ë²„íŠ¼
  startBtn.addEventListener('click', () => {
    if (!items.length) {
      alert('ë¨¼ì € ë©”ë‰´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!');
      return;
    }
    if (currentMode === 'roulette') spinRoulette();
    if (currentMode === 'slot') spinSlot();
    if (currentMode === 'ladder') runLadder();
  });
  function shareKakaoWithoutSDK(text) {
    const shareText = encodeURIComponent(text);
    const shareUrl = encodeURIComponent(location.href);

    const kakaoShareUrl =
      `https://sharer.kakao.com/talk/friends/picker/link?text=${shareText}&url=${shareUrl}`;

    window.open(kakaoShareUrl, '_blank');
  }

  renderUserPresetSelect();

  const lastPresetName = localStorage.getItem(LAST_SELECTED_PRESET_KEY);
  const userPresets = loadUserPresets();

  if (lastPresetName && userPresets[lastPresetName]) {
    // ğŸ” ë§ˆì§€ë§‰ì— ì„ íƒí–ˆë˜ ì„¸íŠ¸ ë³µì›
    items = [...userPresets[lastPresetName]];
    userPresetSelect.value = lastPresetName;
  } else {
    // ê¸°ë³¸ ì„¸íŠ¸
    items = [...presetSets.basic.items];
  }

  renderChips();
  updateView();
</script>
</body>
</html>
