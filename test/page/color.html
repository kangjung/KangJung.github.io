<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë‚´ê°€ ë¹›ë‚˜ëŠ” MBTI ì»¬ëŸ¬</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=SUITE:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --blue: #639aff; --red: #ff6575; --yellow: #ffe16e;
      --purple: #b585ff; --mint: #6cf3cb; --orange: #ffac6e;
      --white: #fff; --gray: #eceaf7; --main: #7153ff; --radius: 18px;
    }
    body { margin:0; background:var(--gray); color:#323246; font-family:'SUITE',sans-serif;}
    .container{max-width:400px;background:var(--white);margin:36px auto 0 auto;border-radius:var(--radius);
      padding:32px 18px 28px 18px; box-shadow:0 9px 40px #a5a8db1f;}
    header{text-align:center;margin-bottom:22px;}
    header h1{font-size:2.08rem;margin-bottom:7px;color:var(--main);font-weight:700;letter-spacing:-0.8px;}
    header .desc{color:#7c5cff;font-size:1.11rem;word-break:keep-all;}
    .progress{width:87%;margin:17px auto 30px auto;height:6px;background:#eee;border-radius:3px;}
    .progress-bar{background:linear-gradient(90deg,var(--main),#ffe16e);height:100%;width:0;
      border-radius:3px;transition:width .3s;}
    .question-area{min-height:120px;font-size:1.13rem;font-weight:600;text-align:center;margin-bottom:20px;}
    .choices{display:flex;flex-direction:column;gap:13px;}
    .choicebtn{border:none;outline:none;background:#eef0fa;font-family:inherit;font-size:1.04rem;
      font-weight:500;color:#435187;padding:17px;border-radius:var(--radius);cursor:pointer;transition:background .16s, color .16s;}
    .choicebtn.selected,.choicebtn:active{background:var(--main);color:#fff;}
    .hide{display:none;}
    .result-area{text-align:center;animation:fadeInUp 0.8s;margin-top:24px;}
    .color-bubble{width:72px;height:72px;border-radius:23px;margin:0 auto 13px auto;display:flex;align-items:center;justify-content:center;
      font-size:2.25rem;box-shadow:0 4px 22px #b5b8df55;}
    .color-blue{background:var(--blue);}
    .color-red{background:var(--red);}
    .color-yellow{background:var(--yellow);}
    .color-purple{background:var(--purple);}
    .color-mint{background:var(--mint);}
    .color-orange{background:var(--orange);}
    .result-title{font-weight:700;font-size:1.33rem;color:var(--main);margin-bottom:2px;}
    .result-keywords{color:#5f74be;font-size:1.01rem;margin-bottom:10px;}
    .result-desc{color:#656087;font-size:1.1rem;margin-bottom:20px;}
    .share-btn{background:var(--main);color:#fff;border:none;border-radius:15px;font-size:1.01rem;width:70%;
      font-family:inherit;font-weight:600;padding:12px 0;margin:auto;display:block;margin-bottom:13px;cursor:pointer;transition:background .13s;}
    .restart-btn{background:#e6e9fa;color:#454175;border:none;border-radius:14px;font-size:0.96rem;width:50%;
      font-family:inherit;font-weight:500;padding:9px 0;margin:auto;display:block;cursor:pointer;transition:background .16s;}
    @media(max-width:480px){.container{padding:12px 2px 16px 2px;}.question-area{font-size:1rem;}}
    @keyframes fadeInUp{0%{opacity:0;transform:translateY(26px);}100%{opacity:1;transform:translateY(0);}}
  </style>
</head>
<body>
<div class="container">
  <header>
    <h1>ë‚´ê°€ ë¹›ë‚˜ëŠ” MBTI ì»¬ëŸ¬</h1>
    <div class="desc">15ë¬¸í•­ìœ¼ë¡œ<br><b>ì°°ë–¡! ë¶„ìœ„ê¸° ì»¬ëŸ¬ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”</b></div>
  </header>
  <div class="progress"><div class="progress-bar"></div></div>
  <div class="question-area"></div>
  <div class="choices"></div>
  <div class="result-area hide"></div>
</div>
<script>
  const QUESTION_COUNT = 15; // ì¶œì œ ê°œìˆ˜
  const COLOR_LIST = ["blue","red","yellow","purple","mint","orange"];
  const BALANCE_RATIO = 0.36; // í•œ ì»¬ëŸ¬ì— ê°€ì¤‘ì¹˜ 36% ì´ìƒ ëª°ë¦¬ë©´ ìš°ì„  ë°°ì œ
  // ì§ˆë¬¸í’€ ì˜ˆì‹œ
  const allColorQuestions = [
    { text:"ê³„íšì„ ì„¸ìš°ëŠ” ê±¸ ì¢‹ì•„í•œë‹¤.",                     scores:{blue:4,purple:2}},
    { text:"ì¦‰í¥ì ì¸ ë„ì „ì„ ì˜ í•˜ëŠ” í¸ì´ë‹¤.",                 scores:{orange:5,red:3}},
    { text:"í˜¼ìë§Œì˜ ì‹œê°„ì—ì„œ ì—ë„ˆì§€ë¥¼ ì¶©ì „í•œë‹¤.",           scores:{mint:5,blue:2}},
    { text:"ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ë©° ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤.",              scores:{yellow:5,orange:3}},
    { text:"ê°ˆë“± ìƒí™©ì—ì„œë„ ì¹¨ì°©í•˜ê²Œ ì˜ê²¬ì„ ë§í•œë‹¤.",         scores:{blue:4,purple:3}},
    { text:"ë‚˜ë¥¼ í‘œí˜„í•˜ëŠ” ê±¸ ì¢‹ì•„í•œë‹¤.",                    scores:{red:5,orange:3}},
    { text:"ì •í•´ì§„ ê²ƒì„ ì§€í‚¤ëŠ” ê±¸ ì¤‘ìš”í•˜ê²Œ ì—¬ê¸´ë‹¤.",         scores:{blue:5,yellow:3}},
    { text:"ë³€í™”ë‚˜ ìƒˆë¡œìš´ ì‹œë„ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•ŠëŠ”ë‹¤.",        scores:{orange:5,mint:3}},
    { text:"ë‚¨ì„ ê³µê°í•˜ê³  ë„ì™€ì£¼ëŠ” ê²Œ ìì—°ìŠ¤ëŸ½ë‹¤.",          scores:{mint:5,yellow:4}},
    { text:"ë‚´ ê°ì •ì— ì†”ì§í•˜ë‹¤.",                           scores:{red:5,purple:3}},
    { text:"ì¦ê²ê³  ìœ ì¾Œí•œ ë¶„ìœ„ê¸°ë¥¼ ì„ í˜¸í•œë‹¤.",               scores:{yellow:5,orange:3}},
    { text:"ë‚˜ë§Œì˜ ì·¨í–¥Â·ê°œì„±ì´ ëšœë ·í•œ í¸ì´ë‹¤.",             scores:{purple:5,red:3}},
    // ì•„ë˜ ì¶”ê°€ í™•ì¥ 14ê°œ (ì˜ˆì‹œ)
    { text:"í˜¼ì ê³„íš ì„¸ìš°ê³  ì¡°ìš©íˆ ì‹¤í–‰í•˜ëŠ” ê²Œ í¸í•˜ë‹¤.",    scores:{blue:4,mint:3}},
    { text:"íƒ€ì¸ì˜ ê°ì •ì— ë¯¼ê°í•˜ê³  ë°°ë ¤ì‹¬ì´ ë§ë‹¤.",          scores:{mint:5,yellow:2}},
    { text:"ìƒˆë¡œìš´ ì‹œë„, ë³€í™”ì— ì„¤ë ˆëŠ” í¸ì´ë‹¤.",             scores:{orange:5,red:2}},
    { text:"ë¦¬ë”ì‹­ì„ ë°œíœ˜í•  ë•Œ ì—ë„ˆì§€ ë„˜ì¹œë‹¤.",              scores:{red:4,blue:2}},
    { text:"í•œ ê³³ì— ì§‘ì¤‘í•˜ê¸°ë³´ë‹¤ ì—¬ëŸ¬ ì¼ ì¦ê¸°ëŠ” í¸ì´ë‹¤.",     scores:{yellow:5,orange:2}},
    { text:"ê°ì„±ì ì´ê³  ì˜ˆìˆ ì  ì²´í—˜ì„ ì¢‹ì•„í•œë‹¤.",            scores:{purple:5,mint:3}},
    { text:"ë‚´ ìŠ¤íƒ€ì¼Â·ì·¨í–¥ ì–´í•„ì— ê±°ë¦¬ë‚Œ ì—†ë‹¤.",             scores:{red:5,purple:3}},
    { text:"ê·œì¹™, ì•½ì†ì€ ì¤‘ìš”í•˜ë‹¤ ìƒê°í•œë‹¤.",               scores:{blue:5,yellow:2}},
    { text:"ê°ì •ì„ ê¹Šì´ ì´í•´í•˜ê³  ê³µê°í•œë‹¤.",                 scores:{mint:5,purple:2}},
    { text:"ì¦‰í¥Â·ëª¨í—˜ì ì¸ ì„ íƒì´ ë‚´ ìŠ¤íƒ€ì¼ì´ë‹¤.",            scores:{orange:5,red:3}},
    { text:"ìƒˆë¡œìš´ ì‚¬ëŒì„ ë§Œë‚˜ëŠ” ê±¸ ì¦ê¸´ë‹¤.",                scores:{yellow:5,orange:4}},
    { text:"ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸°ë¥¼ ì¢‹ì•„í•˜ê³  ì˜ ì „ë‹¬í•œë‹¤.",         scores:{yellow:4,orange:2}},
    { text:"ë‚˜ë§Œì˜ ì°½ì‘, ì·¨ë¯¸ê°€ ì‚¶ì˜ í° ì¦ê±°ì›€ì´ë‹¤.",         scores:{purple:5,mint:2}},
    { text:"ì§‘ì´ë‚˜ ë‚˜ë§Œì˜ ê³µê°„ ê¾¸ë¯¸ê¸°ì— ì‹ ê²½ ì“´ë‹¤.",          scores:{blue:4,mint:3}}
  ];

  const colorResults = [
    { color:"blue",   emoji:"ğŸ”µ", keywords:["ì°¨ë¶„í•¨","ë¯¿ìŒì§í•¨","ì„¬ì„¸í•¨"],bubble:"color-blue",
      description: "ì±…ì„ê° ìˆê³  ì‹ ë¢°ë°›ëŠ” íƒ€ì…. ë…¼ë¦¬ì ì´ë©´ì„œë„ ë¶€ë“œëŸ¬ìš´ ë¶„ìœ„ê¸°, ê¹Šì´ ìˆëŠ” ë§¤ë ¥ì„ ì§€ë‹Œ ë‹¹ì‹ ì—ê²ŒëŠ” í‘¸ë¥¸ìƒ‰ ê³„ì—´ì´ ì˜ ì–´ìš¸ë ¤ìš”!" },
    { color:"red",    emoji:"ğŸ”´", keywords:["ì—´ì •","í‘œí˜„ë ¥","ì§„ì·¨ì "],bubble:"color-red",
      description: "ê°•ë ¬í•˜ê³  ìì‹ ê° ë„˜ì¹˜ëŠ” ìŠ¤íƒ€ì¼! ì£¼ë³€ì„ ì´ë„ëŠ” ì—´ì •, ì†”ì§í•œ ë§¤ë ¥ì˜ ì†Œìœ ìì¸ ë‹¹ì‹ ì€ ë ˆë“œí†¤ ë˜ëŠ” ìƒë™ê° ìˆëŠ” ì»¬ëŸ¬ê°€ ì°°ë–¡ì´ì—ìš”." },
    { color:"yellow", emoji:"ğŸŸ¡", keywords:["ëª…ë‘í•¨","ìœ ì¾Œí•¨","ê¸ì •"],bubble:"color-yellow",
      description: "ë°ê³  ìœ ì¾Œí•´, ëˆ„êµ¬ì™€ë„ ì˜ ì–´ìš¸ë¦¬ëŠ” íƒ€ì…! ë°ì€ ì˜ë¡œìš°, ë¼ì´íŠ¸ê·¸ë¦° ê°™ì€ ê²½ì¾Œí•œ ì»¬ëŸ¬ê°€ ë‹¹ì‹ ì˜ ë§¤ë ¥ì„ í•œê» ë‹ë³´ì´ê²Œ í•  ê±°ì˜ˆìš”." },
    { color:"purple", emoji:"ğŸŸ£", keywords:["ê°œì„±","ìƒìƒë ¥","ììœ ë¶„ë°©"],bubble:"color-purple",
      description: "ë…íŠ¹í•¨ê³¼ ì°½ì˜ë ¥ì´ ë‹ë³´ì´ëŠ” ì˜ˆìˆ ê°€í˜•! ê°ê°ì ì´ë©´ì„œ ì‹ ë¹„ë¡œìš´ í¼í”Œ, ë°”ì´ì˜¬ë › ì»¬ëŸ¬ì™€ ì°°ë–¡ê¶í•©ì…ë‹ˆë‹¤." },
    { color:"mint",   emoji:"ğŸŸ¢", keywords:["í‰ì˜¨í•¨","ê´€ìš©","ê³µê°"],bubble:"color-mint",
      description: "ì°¨ë¶„í•˜ë©´ì„œë„ ë”°ëœ»í•œ ê°ì„±! ë¶€ë“œëŸ½ê³  í‰í™”ë¡œìš´ ë¯¼íŠ¸, ë¼ì´íŠ¸ë¸”ë£¨ ê³„ì—´ì—ì„œ ë‹¹ì‹ ë§Œì˜ ì—¬ìœ ì™€ ë§¤ë ¥ì´ ìì—°ìŠ¤ëŸ½ê²Œ ëŠê»´ì§‘ë‹ˆë‹¤." },
    { color:"orange", emoji:"ğŸŸ ", keywords:["í™œê¸°","ëª¨í—˜","ìœ ì—°í•¨"],bubble:"color-orange",
      description: "í™œë™ì ì´ê³  ììœ ë¡œìš´ ëª¨í—˜ê°€! ë‚™ì²œì ì´ê³  ì—ë„ˆì§€ ë„˜ì¹˜ëŠ” ë‹¹ì‹ ì—ê² ì˜¤ë Œì§€Â·ì½”ë„ ê³„ì—´ì˜ ì»¬ëŸ¬ê°€ ìƒê¸°ë¥¼ í•œê» ë”í•´ì¤„ ê±°ì˜ˆìš”." }
  ];
  // ìƒíƒœ
  let answers = []; let curIdx = 0;
  let colorScores = {};
  let selectedQuestions = [];

  // 5ì  ì²™ë„
  const choiceList = [
    {label:"ë§¤ìš° ê·¸ë ‡ë‹¤",value:5},
    {label:"ê·¸ë ‡ë‹¤",value:4},
    {label:"ë³´í†µ",value:3},
    {label:"ì•„ë‹ˆë‹¤",value:2},
    {label:"ì „í˜€ ì•„ë‹ˆë‹¤",value:1}
  ];
  // DOM
  const $qArea = document.querySelector('.question-area');
  const $choices = document.querySelector('.choices');
  const $result = document.querySelector('.result-area');
  const $progress = document.querySelector('.progress-bar');

  function pickBalancedQuestions(){
    // ì»¬ëŸ¬ë³„ ê°€ì¤‘ì¹˜ê°€ í•œìª½ìœ¼ë¡œ ë„ˆë¬´ ì ë¦¬ë©´ ë‹¤ìŒ í›„ë³´ë¥¼ ê³¨ë¼ êµì²´í•˜ëŠ” ë¡œì§
    let attempts = 0;
    while (attempts < 9) {
      let qPool = [...allColorQuestions].sort(()=>Math.random()-0.5);
      let candidate = qPool.slice(0, QUESTION_COUNT);
      let colorWeight = {};
      COLOR_LIST.forEach(c=>colorWeight[c]=0);
      candidate.forEach(q=>{
        Object.entries(q.scores).forEach(([c, w])=>{
          colorWeight[c] += w;
        });
      });
      const sum = Object.values(colorWeight).reduce((a,b)=>a+b,0);
      const ratios = Object.values(colorWeight).map(val=>val/sum);
      if(Math.max(...ratios) < BALANCE_RATIO) return candidate;
      attempts++;
    }
    // ì‹¤íŒ¨ ì‹œ ì• 15ê°œ ë°˜í™˜
    return allColorQuestions.slice(0, QUESTION_COUNT);
  }

  function renderQuestion(idx){
    const qObj = selectedQuestions[idx];
    $qArea.innerHTML = `<span>${idx+1}. ${qObj.text}</span>`;
    $choices.innerHTML = '';
    choiceList.forEach(c=>{
      const btn = document.createElement('button');
      btn.className = 'choicebtn';
      btn.type = "button";
      btn.innerText = c.label;
      btn.onclick = () => answer(idx, c.value, btn);
      $choices.appendChild(btn);
    });
    $progress.style.width = ((idx/QUESTION_COUNT)*100)+'%';
  }
  function answer(idx, point, btn){
    [...$choices.children].forEach(b=>b.disabled=true);
    btn.classList.add('selected');
    answers[idx]=point;
    setTimeout(()=>{
      if(curIdx < QUESTION_COUNT-1){
        curIdx++; renderQuestion(curIdx);
      } else {
        showResult();
      }
    },330);
  }
  function showResult() {
    colorScores = {};
    COLOR_LIST.forEach(c=>colorScores[c]=0);
    selectedQuestions.forEach((q,qIdx)=>{
      const userPoint = answers[qIdx] || 3;
      Object.entries(q.scores).forEach(([color,weight])=>{
        colorScores[color] += userPoint * weight;
      });
    });
    const sorted = Object.entries(colorScores).sort((a,b)=>b[1]-a[1]);
    const bestColor = sorted[0][0];
    const resultObj = colorResults.find(r=>r.color === bestColor);

    $qArea.classList.add('hide');
    $choices.classList.add('hide');
    $progress.style.width = "100%";
    $result.classList.remove('hide');
    $result.innerHTML = `
    <div class="color-bubble ${resultObj.bubble}">${resultObj.emoji}</div>
    <div class="result-title">${resultObj.color.toUpperCase()}</div>
    <div class="result-keywords">#${resultObj.keywords.join(' #')}</div>
    <div class="result-desc">${resultObj.description}</div>
    <button class="share-btn" onclick="copyColorResult()">ê²°ê³¼ ë³µì‚¬í•˜ê¸°</button>
    <button class="restart-btn" onclick="restartTest()">í…ŒìŠ¤íŠ¸ ë‹¤ì‹œí•˜ê¸°</button>
  `;
  }
  function copyColorResult(){
    const $title = document.querySelector('.result-title').innerText;
    const $desc = document.querySelector('.result-desc').innerText;
    const $keys = document.querySelector('.result-keywords').innerText;
    const txt = `[MBTI ì»¬ëŸ¬ ê²°ê³¼]\n\n${$title}\n${$keys}\n${$desc}\n\nğŸ‘‰ ì§ì ‘ í•´ë³´ê¸°: ${location.origin}${location.pathname}`;
    navigator.clipboard.writeText(txt).then(()=>{
      alert("ê²°ê³¼ê°€ ë³µì‚¬ëì–´ìš”! ì¹œêµ¬ì—ê²Œ ë¶™ì—¬ë„£ê¸° í•´ë³´ì„¸ìš”.");
    });
  }
  function restartTest(){
    answers = []; curIdx = 0; selectedQuestions=pickBalancedQuestions();
    $result.classList.add('hide');
    $qArea.classList.remove('hide');
    $choices.classList.remove('hide');
    renderQuestion(0);
    window.scrollTo({top:0,behavior:'smooth'});
  }
  // ì´ˆê¸° ì‹œì‘
  selectedQuestions=pickBalancedQuestions(); renderQuestion(0);
</script>
</body>
</html>
